# va/error:
#  command: intentionalFailure
#  description: Intentional Failure. Uncomment to test CI system failure behavior.

va/debug/env:
  description: Debug Environment
  command: env

# TODO: These can be removed once the DevShop deploy task runs the install task before it runs the deploy hooks. 
va/deploy/0-composer:
  description: Composer Install
  about: Using --dev is actually the default. Putting it here to make it clear this is the way composer should be run right now.
  command: composer install --dev --no-interaction --no-progress --ansi

va/deploy/1-cache:
  description: Rebuild Drupal caches
  command: drush $DRUSH_ALIAS cr

va/deploy/2-update:
  description: Run Drupal Update Hooks
  command: drush $DRUSH_ALIAS updatedb --yes

va/deploy/3-config:
  - drush $DRUSH_ALIAS cim --yes
  - drush $DRUSH_ALIAS cr

va/web/build:
  description: Build VA.gov Front-end
  command: composer va:web:build | grep  "Failed to pipe Drupal content into Metalsmith!" -B1000 -C8 && echo "Metalsmith error detected in npm build process." && exit 1 || echo "Front end site was built! Check $DRUPAL_ADDRESS/web for raw output!"

va/tests/behat:
  description: Behat Tests
  command: |
    cd tests/behat
    bin/behat --colors

va/tests/phpunit:
  description: PHPUnit
  command: phpunit --exclude-group disabled tests/phpunit --colors=always

va/tests/phpcs:
  description: PHP CodeSniffer
  command: composer va:test:cs

va/tests/phplint:
  description: PHP Lint
  command: composer va:test:lint
